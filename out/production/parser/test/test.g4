(tok_query (tok_from (tok_subquery (tok_query (tok_from (tok_leftouterjoin (tok_leftouterjoin (tok_leftouterjoin (tok_join (tok_tabref (tok_tabname sd_src ts_fa_taccountzqjc) t) (tok_tabref (tok_tabname sd_src ts_fa_tzqxx) b) (= (. (tok_table_or_col t) l_zqnm) (. (tok_table_or_col b) l_zqnm))) (tok_tabref (tok_tabname sd_src ts_fa_tscxx) d) (= (. (tok_table_or_col t) l_sclb) (. (tok_table_or_col d) l_scdm))) (tok_tabref (tok_tabname sd_src ts_fa_tdictionary) t1) (and (= (. (tok_table_or_col t1) l_dictionary_no) '10205') (= (. (tok_table_or_col t1) c_lemma_item) (. (tok_table_or_col b) l_zqlb)))) (tok_tabref (tok_tabname sd_ods tas_book_asset) t2) (= (. (tok_table_or_col t) l_ztbh) (. (tok_table_or_col t2) c_book_code)))) (tok_insert (tok_destination (tok_dir tok_tmp_file)) (tok_select (tok_selexpr (tok_function concat (. (tok_table_or_col a) c_code) 'AJXT') inner_code) (tok_selexpr (. (tok_table_or_col t) d_date) hold_date) (tok_selexpr (tok_function concat (. (tok_table_or_col t) c_zqdm) (tok_function when (= (. (tok_table_or_col t) l_sclb) 1) 'SHSC' (= (. (tok_table_or_col t) l_sclb) 2) 'S2SC' (and (= (. (tok_table_or_col t) l_sclb) 3) (= (. (tok_table_or_col b) l_zqlb) 4)) 'CWGM' (and (= (. (tok_table_or_col t) l_sclb) 3) (= (. (tok_table_or_col b) l_zqlb) 11)) 'CWSM' 'QTSC')) sub_inner_code) (tok_selexpr (. (tok_table_or_col t) c_zqdm) sub_asset_code) (tok_selexpr (. (tok_table_or_col t1) c_item_name) asset_type) (tok_selexpr (tok_function nvl (. (tok_table_or_col d) vc_scmc) 'ø’»±') exchange_id) (tok_selexpr (. (tok_table_or_col t) l_zqcc) quantity) (tok_selexpr (+ (+ (+ (tok_function nvl (. (tok_table_or_col t) f_zqcb) 0) (* (tok_function sign (. (tok_table_or_col t) l_dkfx)) (tok_function nvl (. (tok_table_or_col t) f_ljgz) 0))) (tok_function nvl (. (tok_table_or_col t) f_ljlx) 0)) (tok_function nvl (. (tok_table_or_col t) f_ljzyj) 0)) market_value) (tok_selexpr (/ (+ (+ (+ (tok_function nvl (. (tok_table_or_col t) f_zqcb) 0) (* (tok_function sign (. (tok_table_or_col t) l_dkfx)) (tok_function nvl (. (tok_table_or_col t) f_ljgz) 0))) (tok_function nvl (. (tok_table_or_col t) f_ljlx) 0)) (tok_function nvl (. (tok_table_or_col t) f_ljzyj) 0)) (- (. (tok_table_or_col t2) f_total_ass) (. (tok_table_or_col t2) f_total_liabs))) mvna_ratio) (tok_selexpr (/ (. (tok_table_or_col t) f_zqcb) (. (tok_table_or_col t) l_zqcc)) unit_cost) (tok_selexpr (. (tok_table_or_col t) f_zqcb) total_cost) (tok_selexpr (- (+ (+ (+ (tok_function nvl (. (tok_table_or_col t) f_zqcb) 0) (* (tok_function sign (. (tok_table_or_col t) l_dkfx)) (tok_function nvl (. (tok_table_or_col t) f_ljgz) 0))) (tok_function nvl (. (tok_table_or_col t) f_ljlx) 0)) (tok_function nvl (. (tok_table_or_col t) f_ljzyj) 0)) (. (tok_table_or_col t) f_zqcb)) pl) (tok_selexpr (. (tok_table_or_col t) d_datadate) cretime)) (tok_where (and (and (and (and (= (. (tok_table_or_col t) l_ccfl) 0) (tok_function in (. (tok_table_or_col a) c_rowflag) 'I' 'U')) (tok_function in (. (tok_table_or_col b) c_rowflag) 'I' 'U')) (tok_function in (. (tok_table_or_col t1) c_rowflag) 'I' 'U')) (tok_function in (. (tok_table_or_col t) c_rowflag) 'I' 'U'))))) t3)) (tok_insert (tok_destination (tok_tab (tok_tabname sd_edw mty_fund_bonds_d))) (tok_select (tok_selexpr (tok_function row_number (tok_windowspec (tok_partitioningspec (tok_orderby (tok_tabsortcolnamedesc (tok_nulls_last (tok_table_or_col inner_code))))))) id) (tok_selexpr (tok_table_or_col inner_code)) (tok_selexpr (tok_table_or_col hold_date)) (tok_selexpr (tok_table_or_col sub_inner_code)) (tok_selexpr (tok_table_or_col sub_asset_code)) (tok_selexpr (tok_table_or_col asset_type)) (tok_selexpr (tok_table_or_col exchange_id)) (tok_selexpr (tok_table_or_col quantity)) (tok_selexpr (tok_table_or_col market_value)) (tok_selexpr (tok_table_or_col mvna_ratio)) (tok_selexpr (tok_table_or_col unit_cost)) (tok_selexpr (tok_table_or_col total_cost)) (tok_selexpr (tok_table_or_col pl)) (tok_selexpr (tok_table_or_col cretime)) (tok_selexpr (tok_function from_unixtime (tok_function unix_timestamp) 'yyyy-MM-dd HH:mm:ss') updtime))))